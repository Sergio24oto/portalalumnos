{% extends "base.html" %}

{% block title %}Anuncios · Mini Portal{% endblock %}

{% block content %}
  <h2 style="margin-top:0;">Anuncios</h2>
  
  {% if g.user and g.user.rol == 'admin' %}
  <p><a class="btn" href="{{ url_for('admin.nuevo_anuncio') }}">
    <i class="fa-solid fa-square-plus"></i> Nuevo anuncio
  </a></p>
  {% endif %}

  {% if anuncios|length == 0 %}
    <p class="muted">No hay anuncios todavía.</p>
  {% else %}
    <div class="grid">
      {% for a in anuncios %}
        <article class="card">
          <!-- Badge -->
          <div class="card-badge">
            <i class="fa-solid fa-bullhorn"></i> Anuncio
          </div>

          <h3 class="card-title">{{ a['titulo'] }}</h3>

          <!-- Meta (fecha) -->
          <div class="meta">
            <i class="fa-regular fa-calendar"></i>
            <span>Publicado: {{ a['fecha'] }}</span>
          </div>

          <!-- Contenido -->
          <p style="margin:8px 0 0;">{{ a['contenido'] }}</p>

          <!-- Acciones (solo para admin) -->
          {% if g.user and g.user.rol == 'admin' %}
          <div class="card-actions" style="margin-top:12px;">
            <form method="post" action="{{ url_for('admin.eliminar_anuncio', aid=a['id']) }}" onsubmit="return confirm('¿Eliminar este anuncio?')">
              <button class="btn btn-ghost" type="submit">
                <i class="fa-solid fa-trash-can"></i> Eliminar
              </button>
            </form>
          </div>
          {% endif %}
        </article>
      {% endfor %}
    </div>
  {% endif %}
{% endblock %}
